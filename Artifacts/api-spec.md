{"openapi":"3.1.0","info":{"title":"Platform-Libs Admin API","description":"\n## Full-featured Admin API for platform-libs\n\nThis API exposes all shared library capabilities:\n\n### Authentication\n- Token refresh, logout, introspection\n- User profile retrieval from IdP\n\n### Tenant Management (No Auth Required for Demo)\n- Create, Read, Update, Delete tenants\n- Manage tenant status and entitlements\n\n### Role & Permission Management (Tenant-Scoped)\n- Create and manage roles\n- Define permissions (resource:action)\n- Assign permissions to roles\n\n### User-Role Assignments\n- Assign roles to users (principals)\n- Support for role expiration\n\n### ACL Management\n- Resource-level permission overrides\n- ALLOW/DENY with priority\n\n### Role Hierarchy\n- Define role inheritance\n- Closure table pattern with cycle detection\n\n### Authorization Checking (Current User)\n- GET /api/v1/authz/me/permissions - Get your effective permissions\n- POST /api/v1/authz/check - Check your own authorization\n- POST /api/v1/authz/check/bulk - Bulk check your permissions\n\n### Authorization Checking (Admin)\n- POST /api/v1/authz/check-principal - Check any user's permissions\n\n### Audit Trail\n- Query audit events\n- Verify hash chain integrity\n ","version":"1.0.0"},"paths":{"/api/v1/authz/me/permissions":{"get":{"tags":["Authorization (Current User)","Authorization"],"summary":"Get My Permissions","description":"Get current user's effective permissions.\n\nReturns the authenticated user's:\n- Realm roles (from IdP token)\n- Database roles (assigned in this tenant)\n- Effective permissions (from roles + direct grants)\n\nThis endpoint helps frontends build permission-aware UIs by providing\nall authorization information for the current user in one call.\n\nSecurity: Requires authentication. Returns only the requesting user's\nown permissions (cannot query other users' permissions).","operationId":"get_my_permissions_api_v1_authz_me_permissions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MyPermissionsResponse"}}}}}}},"/api/v1/authz/check":{"post":{"tags":["Authorization (Current User)","Authorization"],"summary":"Check Authorization","description":"Check if user can perform an action on a resource.\n\nEvaluates authorization using the Decision API, which implements\nthe full authorization chain: ACL → RBAC → ABAC (where configured).\n\nThis endpoint is the frontend-facing interface to Layer 3 (Permission Level)\nof the three-layer security model.\n\nUse Cases:\n- Check before showing action buttons (e.g., \"can I delete this study?\")\n- Check before initiating expensive operations\n- Progressive disclosure of UI features based on permissions\n\nSecurity: Requires authentication. Only checks permissions for the\nauthenticated user - cannot check other users' permissions.","operationId":"check_authorization_api_v1_authz_check_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/platform_libs**integrations**fastapi**routes**authz**AuthzCheckRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthzCheckResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/authz/check/bulk":{"post":{"tags":["Authorization (Current User)","Authorization"],"summary":"Bulk Check Authorization","description":"Check multiple authorizations in a single request.\n\nEfficiently checks multiple resource/action combinations for the\ncurrent user. Results are returned in the same order as requests.\n\nUse Cases:\n- Initial page load: check all possible actions for multiple resources\n- List views: check permissions for each item in a table\n- Reduce API round trips for permission checks\n\nLimits:\n- Maximum 100 checks per request\n- All checks use the same principal (current user)","operationId":"bulk_check_authorization_api_v1_authz_check_bulk_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkAuthzCheckRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkAuthzCheckResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"tags":["Info"],"summary":"Root","description":"API information.","operationId":"root**get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"tags":["Health"],"summary":"Health","description":"Health check.","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/auth/refresh":{"post":{"tags":["Auth"],"summary":"Refresh Token","description":"Refresh access token using refresh token.\n\nExchange a valid refresh token for a new access token and refresh token pair.","operationId":"refresh_token_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/logout":{"post":{"tags":["Auth"],"summary":"Logout","description":"Revoke refresh token at IdP (logout).\n\nInvalidates the refresh token, preventing further token refreshes.","operationId":"logout_auth_logout_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/introspect":{"post":{"tags":["Auth"],"summary":"Introspect Local","description":"Check current token validity (from middleware validation).\n\nReturns token claims as validated by the local token validator.\nDoes not contact IdP - uses cached JWKS for validation.","operationId":"introspect_local_auth_introspect_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntrospectResponse"}}}}}}},"/auth/userinfo":{"get":{"tags":["Auth"],"summary":"Get Userinfo","description":"Get user profile from IdP.\n\nFetches user information directly from the IdP userinfo endpoint.\nRequires a valid access token in the Authorization header.","operationId":"get_userinfo_auth_userinfo_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserInfoResponseModel"}}}}}}},"/auth/introspect-remote":{"post":{"tags":["Auth"],"summary":"Introspect Remote","description":"Full IdP introspection (requires client_secret).\n\nPerforms token introspection directly at the IdP.\nRequires OIDC_CLIENT_SECRET to be configured.\nReturns real-time token status from the IdP.","operationId":"introspect_remote_auth_introspect_remote_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntrospectResponse"}}}}}}},"/api/v1/tenants":{"post":{"tags":["Tenants"],"summary":"Create Tenant","description":"Create a new tenant.","operationId":"create_tenant_api_v1_tenants_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Tenants"],"summary":"List Tenants","description":"List all tenants.","operationId":"list_tenants_api_v1_tenants_get","parameters":[{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/tenants/{tenant_id}":{"get":{"tags":["Tenants"],"summary":"Get Tenant","description":"Get a specific tenant.","operationId":"get_tenant_api_v1_tenants__tenant_id__get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Tenants"],"summary":"Update Tenant","description":"Update a tenant.","operationId":"update_tenant_api_v1_tenants__tenant_id__patch","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Tenants"],"summary":"Delete Tenant","description":"Delete a tenant (soft delete by setting status to 'deleted').","operationId":"delete_tenant_api_v1_tenants**tenant_id**delete","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/roles":{"get":{"tags":["Roles"],"summary":"List Roles","description":"List all roles in the current tenant.","operationId":"list_roles_api_v1_roles_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["Roles"],"summary":"Create Role","description":"Create a new role in the current tenant.","operationId":"create_role_api_v1_roles_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/roles/{role_id}":{"delete":{"tags":["Roles"],"summary":"Delete Role","description":"Delete a role.","operationId":"delete_role_api_v1_roles**role_id**delete","parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"string","title":"Role Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/permissions":{"get":{"tags":["Permissions"],"summary":"List Permissions","description":"List all permissions in the current tenant.","operationId":"list_permissions_api_v1_permissions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["Permissions"],"summary":"Create Permission","description":"Create a new permission in the current tenant.","operationId":"create_permission_api_v1_permissions_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/roles/{role_id}/permissions/{permission_id}":{"post":{"tags":["Role-Permissions"],"summary":"Assign Permission To Role","description":"Assign a permission to a role.","operationId":"assign_permission_to_role_api_v1_roles**role_id**permissions**permission_id**post","parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"string","title":"Role Id"}},{"name":"permission_id","in":"path","required":true,"schema":{"type":"string","title":"Permission Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Role-Permissions"],"summary":"Remove Permission From Role","description":"Remove a permission from a role.","operationId":"remove_permission_from_role_api_v1_roles__role_id__permissions__permission_id__delete","parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"string","title":"Role Id"}},{"name":"permission_id","in":"path","required":true,"schema":{"type":"string","title":"Permission Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/roles/{role_id}/permissions":{"get":{"tags":["Role-Permissions"],"summary":"Get Role Permissions","description":"Get all permissions for a role.","operationId":"get_role_permissions_api_v1_roles**role_id**permissions_get","parameters":[{"name":"role_id","in":"path","required":true,"schema":{"type":"string","title":"Role Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/user-roles":{"post":{"tags":["User-Roles"],"summary":"Assign Role To User","description":"Assign a role to a user (principal).","operationId":"assign_role_to_user_api_v1_user_roles_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleAssign"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRoleResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["User-Roles"],"summary":"List User Roles","description":"List user-role assignments.","operationId":"list_user_roles_api_v1_user_roles_get","parameters":[{"name":"principal_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Principal Id"}},{"name":"role_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/user-roles/{principal_id}/{role_id}":{"delete":{"tags":["User-Roles"],"summary":"Remove Role From User","description":"Remove a role from a user.","operationId":"remove_role_from_user_api_v1_user_roles__principal_id___role_id__delete","parameters":[{"name":"principal_id","in":"path","required":true,"schema":{"type":"string","title":"Principal Id"}},{"name":"role_id","in":"path","required":true,"schema":{"type":"string","title":"Role Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/acls":{"post":{"tags":["ACLs"],"summary":"Create Acl","description":"Create an ACL entry.","operationId":"create_acl_api_v1_acls_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ACLCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ACLResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["ACLs"],"summary":"List Acls","description":"List ACL entries.","operationId":"list_acls_api_v1_acls_get","parameters":[{"name":"resource_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Type"}},{"name":"resource_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Id"}},{"name":"subject_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject Type"}},{"name":"subject_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/acls/{acl_id}":{"delete":{"tags":["ACLs"],"summary":"Delete Acl","description":"Delete an ACL entry.","operationId":"delete_acl_api_v1_acls**acl_id**delete","parameters":[{"name":"acl_id","in":"path","required":true,"schema":{"type":"string","title":"Acl Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/role-hierarchy":{"post":{"tags":["Role Hierarchy"],"summary":"Add Role Parent","description":"Add a parent role (child inherits parent's permissions).","operationId":"add_role_parent_api_v1_role_hierarchy_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleHierarchyCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Role Hierarchy"],"summary":"Get Role Hierarchy","description":"Get role hierarchy relationships.","operationId":"get_role_hierarchy_api_v1_role_hierarchy_get","parameters":[{"name":"role_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/authz/check-principal":{"post":{"tags":["Authorization (Admin)"],"summary":"Check Authorization For Principal","description":"Check if ANY principal has permission for a resource/action.\n\nThis is an admin endpoint to check permissions for other users.\nFor checking your own permissions, use:\n- GET /api/v1/authz/me/permissions - Get your effective permissions\n- POST /api/v1/authz/check - Check your own authorization","operationId":"check_authorization_for_principal_api_v1_authz_check_principal_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthzCheckRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/examples**admin_api**main**AuthzCheckResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audit":{"get":{"tags":["Audit"],"summary":"List Audit Events","description":"List audit events for the current tenant.","operationId":"list_audit_events_api_v1_audit_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"activity_category","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Activity Category"}},{"name":"actor_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Actor Id"}},{"name":"resource_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Type"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audit/verify":{"get":{"tags":["Audit"],"summary":"Verify Audit Chain","description":"Verify the integrity of the audit hash chain.","operationId":"verify_audit_chain_api_v1_audit_verify_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ACLCreate":{"properties":{"resource_type":{"type":"string","maxLength":64,"title":"Resource Type"},"resource_id":{"type":"string","maxLength":255,"title":"Resource Id"},"subject_type":{"type":"string","pattern":"^(principal|role|group)$","title":"Subject Type"},"subject_id":{"type":"string","maxLength":255,"title":"Subject Id"},"permission_key":{"type":"string","maxLength":128,"title":"Permission Key"},"effect":{"type":"string","pattern":"^(ALLOW|DENY)$","title":"Effect"},"priority":{"type":"integer","title":"Priority","default":0},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"}},"type":"object","required":["resource_type","resource_id","subject_type","subject_id","permission_key","effect"],"title":"ACLCreate"},"ACLResponse":{"properties":{"id":{"type":"string","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"resource_type":{"type":"string","title":"Resource Type"},"resource_id":{"type":"string","title":"Resource Id"},"subject_type":{"type":"string","title":"Subject Type"},"subject_id":{"type":"string","title":"Subject Id"},"permission_key":{"type":"string","title":"Permission Key"},"effect":{"type":"string","title":"Effect"},"priority":{"type":"integer","title":"Priority"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"}},"type":"object","required":["id","tenant_id","resource_type","resource_id","subject_type","subject_id","permission_key","effect","priority","reason","created_at","expires_at"],"title":"ACLResponse"},"AuthzCheckRequest":{"properties":{"principal_id":{"type":"string","title":"Principal Id"},"resource_type":{"type":"string","title":"Resource Type"},"resource_id":{"type":"string","title":"Resource Id"},"action":{"type":"string","title":"Action"}},"type":"object","required":["principal_id","resource_type","resource_id","action"],"title":"AuthzCheckRequest"},"AuthzCheckResponse":{"properties":{"allowed":{"type":"boolean","title":"Allowed","description":"Whether the action is allowed"},"decision_type":{"type":"string","title":"Decision Type","description":"Decision type: ALLOW, DENY, or ALLOW_WITH_OBLIGATIONS"},"reason_codes":{"items":{"type":"string"},"type":"array","title":"Reason Codes","description":"Reason codes explaining the decision"},"decision_id":{"type":"string","title":"Decision Id","description":"Unique decision ID for audit trail","default":""},"cached":{"type":"boolean","title":"Cached","description":"Whether this was a cached decision","default":false},"obligations":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Obligations","description":"Obligations that must be fulfilled (if ALLOW_WITH_OBLIGATIONS)"}},"type":"object","required":["allowed","decision_type"],"title":"AuthzCheckResponse","description":"Response for POST /check endpoint."},"BulkAuthzCheckRequest":{"properties":{"checks":{"items":{"$ref":"#/components/schemas/platform_libs**integrations**fastapi**routes**authz**AuthzCheckRequest"},"type":"array","maxItems":100,"minItems":1,"title":"Checks","description":"List of authorization checks to perform"}},"type":"object","required":["checks"],"title":"BulkAuthzCheckRequest","description":"Request for bulk authorization checks."},"BulkAuthzCheckResponse":{"properties":{"results":{"items":{"$ref":"#/components/schemas/AuthzCheckResponse"},"type":"array","title":"Results","description":"Results in same order as requests"}},"type":"object","required":["results"],"title":"BulkAuthzCheckResponse","description":"Response for bulk authorization checks."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IntrospectResponse":{"properties":{"active":{"type":"boolean","title":"Active"},"exp":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Exp"},"tenant_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tenant Id"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"roles":{"items":{"type":"string"},"type":"array","title":"Roles","default":[]},"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject"},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"}},"type":"object","required":["active"],"title":"IntrospectResponse"},"LogoutRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token","description":"Refresh token to revoke"}},"type":"object","required":["refresh_token"],"title":"LogoutRequest"},"LogoutResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","message"],"title":"LogoutResponse"},"MyPermissionsResponse":{"properties":{"principal_id":{"type":"string","format":"uuid","title":"Principal Id","description":"Current user's principal ID"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id","description":"Current tenant ID"},"realm_roles":{"items":{"type":"string"},"type":"array","title":"Realm Roles","description":"Realm-level roles from IdP (e.g., 'admin', 'user')"},"roles":{"items":{"$ref":"#/components/schemas/RoleInfo"},"type":"array","title":"Roles","description":"Database roles assigned to user in this tenant"},"permissions":{"items":{"$ref":"#/components/schemas/PermissionInfo"},"type":"array","title":"Permissions","description":"Effective permissions (from roles + direct grants)"}},"type":"object","required":["principal_id","tenant_id"],"title":"MyPermissionsResponse","description":"Response for GET /me/permissions endpoint."},"PermissionCreate":{"properties":{"resource":{"type":"string","maxLength":100,"minLength":1,"title":"Resource"},"action":{"type":"string","maxLength":50,"minLength":1,"title":"Action"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"}},"type":"object","required":["resource","action"],"title":"PermissionCreate"},"PermissionInfo":{"properties":{"resource":{"type":"string","title":"Resource","description":"Resource type (e.g., 'study', 'patient')"},"action":{"type":"string","title":"Action","description":"Action (e.g., 'read', 'write', 'delete')"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Human-readable description"}},"type":"object","required":["resource","action"],"title":"PermissionInfo","description":"Permission information."},"PermissionResponse":{"properties":{"id":{"type":"string","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"resource":{"type":"string","title":"Resource"},"action":{"type":"string","title":"Action"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","tenant_id","resource","action","description","created_at"],"title":"PermissionResponse"},"RefreshTokenRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token","description":"Refresh token from previous authentication"}},"type":"object","required":["refresh_token"],"title":"RefreshTokenRequest"},"RefreshTokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"expires_in":{"type":"integer","title":"Expires In"},"token_type":{"type":"string","title":"Token Type","default":"Bearer"},"scope":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scope"}},"type":"object","required":["access_token","refresh_token","expires_in"],"title":"RefreshTokenResponse"},"RoleCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"is_system":{"type":"boolean","title":"Is System","default":false}},"type":"object","required":["name"],"title":"RoleCreate"},"RoleHierarchyCreate":{"properties":{"parent_role_id":{"type":"string","title":"Parent Role Id"},"child_role_id":{"type":"string","title":"Child Role Id"}},"type":"object","required":["parent_role_id","child_role_id"],"title":"RoleHierarchyCreate"},"RoleInfo":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Role UUID"},"name":{"type":"string","title":"Name","description":"Role name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Role description"},"is_system":{"type":"boolean","title":"Is System","description":"Whether this is a system role","default":false}},"type":"object","required":["id","name"],"title":"RoleInfo","description":"Role information."},"RoleResponse":{"properties":{"id":{"type":"string","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"is_system":{"type":"boolean","title":"Is System"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","tenant_id","name","description","is_system","created_at"],"title":"RoleResponse"},"TenantCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name"},"slug":{"type":"string","maxLength":100,"minLength":1,"pattern":"^[a-z0-9-]+$","title":"Slug"},"status":{"type":"string","title":"Status","default":"active"},"entitlements":{"additionalProperties":true,"type":"object","title":"Entitlements"},"settings":{"additionalProperties":true,"type":"object","title":"Settings"}},"type":"object","required":["name","slug"],"title":"TenantCreate"},"TenantResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"slug":{"type":"string","title":"Slug"},"status":{"type":"string","title":"Status"},"entitlements":{"additionalProperties":true,"type":"object","title":"Entitlements"},"settings":{"additionalProperties":true,"type":"object","title":"Settings"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","name","slug","status","entitlements","settings","created_at","updated_at"],"title":"TenantResponse"},"TenantUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"},"entitlements":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Entitlements"},"settings":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Settings"}},"type":"object","title":"TenantUpdate"},"UserInfoResponseModel":{"properties":{"sub":{"type":"string","title":"Sub"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"email_verified":{"type":"boolean","title":"Email Verified","default":false},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"given_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Given Name"},"family_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Family Name"},"preferred_username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Preferred Username"},"tenant_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tenant Id"},"roles":{"items":{"type":"string"},"type":"array","title":"Roles","default":[]}},"type":"object","required":["sub"],"title":"UserInfoResponseModel"},"UserRoleAssign":{"properties":{"principal_id":{"type":"string","title":"Principal Id"},"role_id":{"type":"string","title":"Role Id"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"}},"type":"object","required":["principal_id","role_id"],"title":"UserRoleAssign"},"UserRoleResponse":{"properties":{"principal_id":{"type":"string","title":"Principal Id"},"role_id":{"type":"string","title":"Role Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"assigned_at":{"type":"string","format":"date-time","title":"Assigned At"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"}},"type":"object","required":["principal_id","role_id","tenant_id","assigned_at","expires_at"],"title":"UserRoleResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"examples**admin_api**main**AuthzCheckResponse":{"properties":{"allowed":{"type":"boolean","title":"Allowed"},"reason":{"type":"string","title":"Reason"},"matched_roles":{"items":{"type":"string"},"type":"array","title":"Matched Roles"},"matched_permissions":{"items":{"type":"string"},"type":"array","title":"Matched Permissions"},"acl_overrides":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Acl Overrides"}},"type":"object","required":["allowed","reason","matched_roles","matched_permissions","acl_overrides"],"title":"AuthzCheckResponse"},"platform_libs**integrations**fastapi**routes**authz**AuthzCheckRequest":{"properties":{"resource_type":{"type":"string","maxLength":100,"minLength":1,"title":"Resource Type","description":"Resource type to check (e.g., 'study', 'patient', 'report')"},"resource_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Id","description":"Optional specific resource ID for instance-level checks"},"action":{"type":"string","maxLength":50,"minLength":1,"title":"Action","description":"Action to check (e.g., 'read', 'write', 'delete', 'share')"},"context":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Context","description":"Optional context for ABAC policy evaluation"}},"type":"object","required":["resource_type","action"],"title":"AuthzCheckRequest","description":"Request for POST /check endpoint."}}}}
